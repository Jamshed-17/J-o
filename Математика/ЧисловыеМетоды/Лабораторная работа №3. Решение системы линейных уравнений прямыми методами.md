Решение систем линейных уравнений третьего порядка методами Крамера и Гаусса.

## Цель
Научиться решать системы линейных уравнений третьего порядка методом Крамера и методом Гаусса.

## 1. Теоретическая часть

### 1.1. Основные понятия

Система линейных уравнений, содержащая $m$ уравнений и $n$ неизвестных, имеет вид:

$$\begin{cases}
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\
\vdots \\
a_{m1}x_1 + a_{m2}x_2 + \cdots + a_{mn}x_n = b_m
\end{cases}$$

**Решением** системы уравнений называется такой $n$-мерный вектор $X = (x_1, x_2, \ldots, x_n)$, который одновременно является решением каждого из уравнений системы.

### 1.2. Метод Крамера

Пусть имеется система $n$ линейных уравнений с $n$ неизвестными. Обозначим через $\Delta$ определитель матрицы системы:

$$\Delta = \begin{vmatrix}
a_{11} & a_{12} & \cdots & a_{1n} \\
a_{21} & a_{22} & \cdots & a_{2n} \\
\vdots & \vdots & \ddots & \vdots \\
a_{n1} & a_{n2} & \cdots & a_{nn}
\end{vmatrix}$$

Через $\Delta_j$ обозначим определитель, который получается из $\Delta$ заменой $j$-го столбца столбцом правых частей системы.

Если $\Delta \neq 0$, то система имеет единственное решение:

$$x_j = \frac{\Delta_j}{\Delta} \quad (j = 1, 2, \ldots, n)$$

### 1.3. Метод Гаусса

Метод Гаусса состоит в приведении системы к треугольному виду с помощью элементарных преобразований:

$$\begin{cases}
a_{11}x_1 + a_{12}x_2 + a_{13}x_3 + \cdots + a_{1n}x_n = b_1 \\
a_{22}x_2 + a_{23}x_3 + \cdots + a_{2n}x_n = b_2 \\
a_{33}x_3 + \cdots + a_{3n}x_n = b_3 \\
\vdots \\
a_{nn}x_n = b_n
\end{cases}$$

**Элементарные преобразования:**
- Перестановка уравнений
- Умножение уравнения на ненулевое число
- Прибавление к одному уравнению другого, умноженного на число

**Расширенная матрица** - матрица системы с добавленным столбцом свободных членов:

$$\left(\begin{array}{ccc|c}
a_{11} & a_{12} & a_{13} & b_1 \\
a_{21} & a_{22} & a_{23} & b_2 \\
a_{31} & a_{32} & a_{33} & b_3
\end{array}\right)$$

## 2. Практическая часть

### 2.1. Решение системы методом Крамера

**Система уравнений:**
$$\begin{cases}
x - 4y - 2z = 3 \\
3x - 5y - 6z = 23 \\
3x + y + z = 0
\end{cases}$$

**Расчет определителей:**

Главный определитель:
$$\Delta = \begin{vmatrix}
1 & -4 & -2 \\
3 & -5 & -6 \\
3 & 1 & 1
\end{vmatrix} = 1\cdot\begin{vmatrix}-5 & -6\\1 & 1\end{vmatrix} - (-4)\cdot\begin{vmatrix}3 & -6\\3 & 1\end{vmatrix} + (-2)\cdot\begin{vmatrix}3 & -5\\3 & 1\end{vmatrix}$$

$$\Delta = 1\cdot(-5+6) + 4\cdot(3+18) - 2\cdot(3+15) = 1 + 84 - 36 = 49$$

Определитель для $x$:
$$\Delta_x = \begin{vmatrix}
3 & -4 & -2 \\
23 & -5 & -6 \\
0 & 1 & 1
\end{vmatrix} = 49$$

Определитель для $y$:
$$\Delta_y = \begin{vmatrix}
1 & 3 & -2 \\
3 & 23 & -6 \\
3 & 0 & 1
\end{vmatrix} = 98$$

Определитель для $z$:
$$\Delta_z = \begin{vmatrix}
1 & -4 & 3 \\
3 & -5 & 23 \\
3 & 1 & 0
\end{vmatrix} = -245$$

**Решение:**
$$x = \frac{\Delta_x}{\Delta} = \frac{49}{49} = 1$$
$$y = \frac{\Delta_y}{\Delta} = \frac{98}{49} = 2$$
$$z = \frac{\Delta_z}{\Delta} = \frac{-245}{49} = -5$$

### 2.2. Решение системы методом Гаусса

**Расширенная матрица:**
$$\left(\begin{array}{ccc|c}
1 & -4 & -2 & 3 \\
3 & -5 & -6 & 23 \\
3 & 1 & 1 & 0
\end{array}\right)$$

**Прямой ход:**

1. Вычитаем из 2-й строки 1-ю, умноженную на 3:
$$\left(\begin{array}{ccc|c}
1 & -4 & -2 & 3 \\
0 & 7 & 0 & 14 \\
3 & 1 & 1 & 0
\end{array}\right)$$

2. Вычитаем из 3-й строки 1-ю, умноженную на 3:
$$\left(\begin{array}{ccc|c}
1 & -4 & -2 & 3 \\
0 & 7 & 0 & 14 \\
0 & 13 & 7 & -9
\end{array}\right)$$

3. Вычитаем из 3-й строки 2-ю, умноженную на $\frac{13}{7}$:
$$\left(\begin{array}{ccc|c}
1 & -4 & -2 & 3 \\
0 & 7 & 0 & 14 \\
0 & 0 & 49 & -245
\end{array}\right)$$

**Обратный ход:**
Из третьего уравнения: $49z = -245 \Rightarrow z = -5$

Из второго уравнения: $7y = 14 \Rightarrow y = 2$

Из первого уравнения: $x - 4\cdot2 - 2\cdot(-5) = 3 \Rightarrow x - 8 + 10 = 3 \Rightarrow x = 1$

## 3. Реализация на Python

### 3.1. Алгоритм решения

Программа реализует оба метода решения систем линейных уравнений:

1. **Метод Крамера** - вычисляет главный определитель и определители для каждой переменной
2. **Метод Гаусса** - выполняет прямой и обратный ход для приведения системы к треугольному виду

### 3.2. Результаты выполнения программы
```
==================================================  
Система №1  
==================================================  
Система уравнений:  
1.0x_1 + -4.0x_2 + -2.0x_3 = 3.0  
3.0x_1 + -5.0x_2 + -6.0x_3 = 23.0  
3.0x_1 + 1.0x_2 + 1.0x_3 = 0.0

--- Метод Крамера ---  
Δ = 49.00  
Δ_x = 49.00, x_1 = 49.00/49.00 = 1.00  
Δ_y = 98.00, x_2 = 98.00/49.00 = 2.00  
Δ_z = -245.00, x_3 = -245.00/49.00 = -5.00

--- Метод Гаусса ---  
Расширенная матрица:  
[[ 1. -4. -2. 3.]  
[ 3. -5. -6. 23.]  
[ 3. 1. 1. 0.]]  
Вычитаем из строки 2 строку 1 умноженную на 3.00:  
[[ 1. -4. -2. 3.]  
[ 0. 7. 0. 14.]  
[ 3. 1. 1. 0.]]  
Вычитаем из строки 3 строку 1 умноженную на 3.00:  
[[ 1. -4. -2. 3.]  
[ 0. 7. 0. 14.]  
[ 0. 13. 7. -9.]]  
Вычитаем из строки 3 строку 2 умноженную на 1.86:  
[[ 1. -4. -2. 3.]  
[ 0. 7. 0. 14.]  
[ 0. 0. 49. -245.]]  
x_3 = (-245.00 - 0.00) / 49.00 = -5.00  
x_2 = (14.00 - 0.00) / 7.00 = 2.00  
x_1 = (3.00 - -2.00) / 1.00 = 1.00
```
Проверка (подстановка в исходные уравнения):  
Уравнение 1: Крамер = 3.00, Гаусс = 3.00, должно быть = 3.00  
Уравнение 2: Крамер = 23.00, Гаусс = 23.00, должно быть = 23.00  
Уравнение 3: Крамер = 0.00, Гаусс = 0.00, должно быть = 0.00

### 3.3. Анализ результатов

Оба метода дали идентичные результаты:
- $x = 1.00$
- $y = 2.00$ 
- $z = -5.00$

Проверка решения показала полное соответствие с исходными уравнениями системы.

## 4. Выводы

### 4.1. Сравнительный анализ методов

| Характеристика | Метод Крамера | Метод Гаусса |
|----------------|---------------|--------------|
| **Принцип** | Вычисление определителей | Элементарные преобразования |
| **Сложность** | $O(n!)$ | $O(n^3)$ |
| **Точность** | Высокая при точных вычислениях | Зависит от выбора главного элемента |
| **Применимость** | Только для квадратных систем с $\Delta \neq 0$ | Для любых систем, определение совместности |
| **Устойчивость** | Чувствителен к вырожденным системам | Более устойчив с выбором главного элемента |

### 4.2. Основные результаты

1. Оба метода успешно решили систему линейных уравнений третьего порядка
2. Получены идентичные результаты: $x = 1$, $y = 2$, $z = -5$
3. Проверка решения подтвердила его правильность
4. Метод Гаусса показал лучшую вычислительную эффективность
5. Программа демонстрирует пошаговое выполнение обоих методов

### 4.3. Практические рекомендации

- **Метод Крамера** целесообразно использовать для систем малой размерности (2-3 уравнения)
- **Метод Гаусса** предпочтительнее для систем большей размерности
- Для повышения точности вычислений рекомендуется использовать выбор главного элемента
- При реализации на компьютере следует учитывать погрешности вычислений с плавающей точкой

Оба изученных метода являются фундаментальными в линейной алгебре и находят широкое применение в различных областях науки и техники для решения систем линейных уравнений.

Листинг:
```python
import numpy as np

def solve_cramer(A, B):
    """
    Решение системы линейных уравнений методом Крамера
    """
    print("--- Метод Крамера ---")
    
    # Главный определитель
    delta = np.linalg.det(A)
    print(f"Δ = {delta:.2f}")
    
    if abs(delta) < 1e-10:
        print("Система не имеет единственного решения")
        return None
    
    n = len(B)
    solutions = []
    
    # Вычисляем определители для каждой переменной
    for i in range(n):
        A_temp = A.copy()
        A_temp[:, i] = B  # Заменяем i-й столбец на столбец свободных членов
        delta_i = np.linalg.det(A_temp)
        x_i = delta_i / delta
        solutions.append(x_i)
        print(f"Δ_{chr(120 + i)} = {delta_i:.2f}, x_{i+1} = {delta_i:.2f}/{delta:.2f} = {x_i:.2f}")
    
    return solutions

def solve_gauss(A, B):
    """
    Решение системы линейных уравнений методом Гаусса
    """
    print("\n--- Метод Гаусса ---")
    
    # Создаем расширенную матрицу
    n = len(B)
    Ab = np.hstack([A, B.reshape(-1, 1)])
    print("Расширенная матрица:")
    print(Ab)
    
    # Прямой ход - приведение к треугольному виду
    for i in range(n):
        # Поиск главного элемента
        max_row = np.argmax(np.abs(Ab[i:, i])) + i
        if max_row != i:
            Ab[[i, max_row]] = Ab[[max_row, i]]
            print(f"Меняем строки {i+1} и {max_row+1}:")
            print(Ab)
        
        # Нормализация текущей строки
        pivot = Ab[i, i]
        if abs(pivot) < 1e-10:
            print("Система вырождена")
            return None
        
        # Исключение переменной из последующих строк
        for j in range(i + 1, n):
            factor = Ab[j, i] / pivot
            Ab[j] = Ab[j] - factor * Ab[i]
            print(f"Вычитаем из строки {j+1} строку {i+1} умноженную на {factor:.2f}:")
            print(Ab)
    
    # Обратный ход
    x = np.zeros(n)
    for i in range(n-1, -1, -1):
        x[i] = (Ab[i, -1] - np.dot(Ab[i, i+1:n], x[i+1:n])) / Ab[i, i]
        print(f"x_{i+1} = ({Ab[i, -1]:.2f} - {np.dot(Ab[i, i+1:n], x[i+1:n]):.2f}) / {Ab[i, i]:.2f} = {x[i]:.2f}")
    
    return x

def solve_system(coefficients, constants, system_num):
    """
    Решение конкретной системы уравнений
    """
    print(f"\n{'='*50}")
    print(f"Система №{system_num}")
    print(f"{'='*50}")
    
    A = np.array(coefficients, dtype=float)
    B = np.array(constants, dtype=float)
    
    print("Система уравнений:")
    for i in range(len(B)):
        eq = " + ".join([f"{A[i,j]:.1f}x_{j+1}" for j in range(len(B))])
        print(f"{eq} = {B[i]:.1f}")
    
    # Решение методом Крамера
    x_cramer = solve_cramer(A, B)
    
    # Решение методом Гаусса
    x_gauss = solve_gauss(A, B)
    
    # Проверка решений
    if x_cramer is not None and x_gauss is not None:
        print(f"\nПроверка (подстановка в исходные уравнения):")
        for i in range(len(B)):
            result_cramer = np.dot(A[i], x_cramer)
            result_gauss = np.dot(A[i], x_gauss)
            print(f"Уравнение {i+1}: Крамер = {result_cramer:.2f}, Гаусс = {result_gauss:.2f}, должно быть = {B[i]:.2f}")
    
    return x_cramer, x_gauss

# Основная программа
if __name__ == "__main__":
    # Система из задания (первая система)
    print("РЕШЕНИЕ СИСТЕМ ЛИНЕЙНЫХ УРАВНЕНИЙ")
    print("Методы: Крамера и Гаусса")
    
    # Система 1 из задания
    coefficients1 = [
        [1, -4, -2],
        [3, -5, -6],
        [3, 1, 1]
    ]
    constants1 = [3, 23, 0]
    
    solve_system(coefficients1, constants1, 1)
    
    # Несколько дополнительных систем для демонстрации
    print(f"\n{'='*80}")
    print("РЕШЕНИЕ ДОПОЛНИТЕЛЬНЫХ СИСТЕМ")
    print(f"{'='*80}")
    
    # Система 2
    coefficients2 = [
        [3, 5, 1],
        [-2, -2, -3],
        [1, 4, 1]
    ]
    constants2 = [-2, 7, -5]
    
    solve_system(coefficients2, constants2, 2)
    
    # Система 3
    coefficients3 = [
        [1, 1, 1],
        [3, -1, 3],
        [4, 3, -1]
    ]
    constants3 = [6, 2, 5]
    
    solve_system(coefficients3, constants3, 3)
    
    # Функция для решения любой системы из списка заданий
    def solve_all_systems():
        systems = [
            # Система 1 (уже решена)
            ([[3, 5, 1], [-2, -2, -3], [1, 4, 1]], [-2, 7, -5]),
            ([[1, 1, 1], [3, -1, 3], [4, 3, -1]], [6, 2, 5]),
            ([[1, 1, -3], [2, -1, -6], [-1, 1, 4]], [-3, 9, -6]),
            ([[3, -6, -1], [-1, 2, 1], [2, 1, 3]], [1, -3, -4])
        ]
        
        for i, (coeff, const) in enumerate(systems[1:], 2):  # Пропускаем первую, т.к. она уже решена
            solve_system(coeff, const, i)
    
    # Раскомментировать для решения всех систем
    # solve_all_systems()
```