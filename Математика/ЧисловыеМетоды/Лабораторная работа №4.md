# Решение системы линейных уравнений (вариант 1)

## Цель

Научиться решать системы линейных уравнений четвёртого порядка методом Гаусса, находить обратную матрицу, оценивать абсолютные и относительные погрешности, а также применять итерационные методы (в том числе метод Якоби — по варианту).

---

## 1. Теоретическая часть

Система линейных уравнений имеет вид:

$$
\begin{cases}
a_{11}x_1 + a_{12}x_2 + \ldots + a_{1n}x_n = b_1, \\
a_{21}x_1 + a_{22}x_2 + \ldots + a_{2n}x_n = b_2, \\
\vdots \\
a_{n1}x_1 + a_{n2}x_2 + \ldots + a_{nn}x_n = b_n.
\end{cases}
$$

Метод Гаусса заключается в последовательном исключении неизвестных, приводя систему к треугольному виду, а затем выполняя обратный ход.

Методы Якоби и Зейделя являются итерационными и основаны на приведении системы к виду:

$$
x = Bx + c,
$$

где  

$$
B = -D^{-1}(L + R), \qquad c = D^{-1}b.
$$

---

## 2. Практическая часть

### 2.1. Исходная система (вариант 1)

$$
\begin{cases}
0.946x_1 + 0.628x_2 + 3.215x_3 + 0.194x_4 = 0.412, \\
0.213x_1 + 0.429x_2 + 0.997x_3 + 2.351x_4 = 0.297, \\
0.021x_1 + 0.375x_2 + 0.326x_3 + 0.273x_4 = 3.416, \\
0.425x_1 + 0.281x_2 + 0.519x_3 + 0.207x_4 = 0.003.
\end{cases}
$$

---

### 2.2. Решение методом Гаусса

Решение, полученное численно:

$$
\begin{cases}
x_1 = -6.259293, \\
x_2 = 10.308304, \\
x_3 = 0.028751, \\
x_4 = -1.199786.
\end{cases}
$$

---

### 2.3. Обратная матрица

$$
A^{-1} =
\begin{pmatrix}
-0.3155 & -0.0445 & -1.7932 &  3.1660 \\
-0.3081 & -0.3977 &  3.0888 &  0.7325 \\
0.4710  &  0.0621 & -0.0528 & -1.0769 \\
-0.1149 &  0.4756 & -0.3787 &  0.0362
\end{pmatrix}
$$

---

### 2.4. Оценка погрешностей

Абсолютная погрешность свободных членов:

$$
\Delta b = 10^{-3}.
$$

Норма матрицы \( A \):

$$
\|A\| = 5.057.
$$

Норма обратной матрицы:

$$
\|A^{-1}\| = 5.314.
$$

Абсолютная погрешность решения:

$$
\|\Delta x\| \le \|A^{-1}\| \cdot \|\Delta b\| = 5.314 \times 10^{-3} = 0.0053135.
$$

Относительная погрешность:

$$
\frac{\|\Delta x\|}{\|x\|} \le \|A^{-1}\| \cdot \|A\| \cdot \frac{\|\Delta b\|}{\|b\|} \approx 7.866 \times 10^{-3}.
$$

---

### 2.5. Подготовка к итерационным методам

Матрица \( A \) разбивается на диагональную и внедиагональную части:

$$
A = D + (L + R),
$$

и система приводится к виду:

$$
x = -D^{-1}(L + R)x + D^{-1}b,
$$

где  

$$
B = -D^{-1}(L + R), \qquad c = D^{-1}b.
$$

Полученные матрица и вектор:

$$
B =
\begin{pmatrix}
0 & -0.664 & -3.399 & -0.205 \\
-0.497 & 0 & -2.324 & -5.480 \\
-0.064 & -1.150 & 0 & -0.837 \\
-2.053 & -1.357 & -2.507 & 0
\end{pmatrix},
\qquad
c =
\begin{pmatrix}
0.436 \\
0.692 \\
10.479 \\
0.014
\end{pmatrix}.
$$

---

### 2.6. Анализ сходимости метода Якоби

Норма матрицы итераций:

$$
\|B\| = 8.23 > 1.
$$

Так как  

$$
\|B\| > 1,
$$  

**метод Якоби не сходится** для данной системы.

При попытке численного выполнения итераций наблюдалась расходимость: значения переменных растут до бесконечности, что подтверждает теоретический вывод о несходимости.

---

## 3. Анализ результатов

- Метод Гаусса дал устойчивое и точное решение.  
- Метод Якоби по варианту — не сходится из-за большой нормы матрицы итераций.  
- Абсолютная погрешность решения при  
  \( \Delta b = 10^{-3} \)  
  не превышает  

  $$
  \|\Delta x\| \le 0.0053.
  $$

- Относительная погрешность составляет около  

  $$
  0.8\%.
  $$

---

## 4. Выводы

1. Система линейных уравнений четвёртого порядка успешно решена методом Гаусса.  
2. Найдена обратная матрица и рассчитаны нормы.  
3. Оценены абсолютная и относительная погрешности решения.  
4. Метод Якоби (вариант 1) оказался **расходящимся**, так как  

   $$
   \|B\| > 1.
   $$

5. Для итерационного решения рекомендуется применять метод Зейделя или метод релаксации (SOR) с выбором параметра  

   $$
   \omega \in (0, 2).
   $$

---

## 5. Основные численные результаты

| Величина | Значение |
|-----------|-----------|
| \( \|A\| \) | 5.057 |
| \( \|A^{-1}\| \) | 5.314 |
| \( \|\Delta x\| \) | ≤ 0.0053135 |
| \( \frac{\|\Delta x\|}{\|x\|} \) | ≈ 0.007866 |
| \( \|B\| \) | 8.23 |
| Итерации Якоби | не сошлись |
| Решение Гаусса | \( (-6.2593,\; 10.3083,\; 0.0288,\; -1.1998) \) |

---

## 6. Заключение

Метод Гаусса подтвердил высокую устойчивость и точность при решении систем линейных уравнений.  
Метод Якоби в данном варианте не удовлетворяет условию сходимости, что иллюстрирует важность предварительного анализа матрицы системы.  
Полученные оценки погрешностей показывают, что прямое решение обладает хорошей численной устойчивостью.


Реализация на Python

```python
import numpy as np

# Исходная матрица и вектор (вариант 1, взято из PDF)
A = np.array([
    [0.946, 0.628, 3.215, 0.194],
    [0.213, 0.429, 0.997, 2.351],
    [0.021, 0.375, 0.326, 0.273],
    [0.425, 0.281, 0.519, 0.207]
], dtype=float)

b = np.array([0.412, 0.297, 3.416, 0.003], dtype=float)

# Метод Гаусса (numpy.linalg.solve)
x_gauss = np.linalg.solve(A, b)

# Обратная матрица
A_inv = np.linalg.inv(A)

# Нормы (максимум по столбцам, как в методичке)
norm_A = np.max(np.sum(np.abs(A), axis=0))
norm_Ainv = np.max(np.sum(np.abs(A_inv), axis=0))

# Оценка погрешностей (Δb = 1e-3)
db = 1e-3
abs_err_bound = norm_Ainv * db
b_inf_norm = np.max(np.abs(b))
rel_err_bound = norm_Ainv * norm_A * (db / b_inf_norm)

# Подготовка к итерациям (Якоби)
D = np.diag(np.diag(A))
Dinv = np.linalg.inv(D)
B = np.eye(4) - Dinv @ A   # = -Dinv*(A-D)
c = Dinv @ b

# Норма матрицы B
norm_B_col = np.max(np.sum(np.abs(B), axis=0))
norm_B_row = np.max(np.sum(np.abs(B), axis=1))

# Попытка итераций Якоби
def jacobi_iter(A, b, tol=1e-3, maxiter=10000):
    n = A.shape[0]
    x = np.zeros(n)
    D = np.diag(np.diag(A))
    R = A - D
    Dinv = np.linalg.inv(D)
    B = -Dinv @ R
    c = Dinv @ b
    for k in range(1, maxiter+1):
        x_new = B @ x + c
        if np.linalg.norm(x_new - x, ord=np.inf) < tol:
            return x_new, k
        x = x_new
    return x, maxiter

x_jacobi, k_jacobi = jacobi_iter(A, b, tol=1e-3, maxiter=10000)

# Вывод
print("Gaussian solution:", x_gauss)
print("A_inv:\n", A_inv)
print("||A|| (col) =", norm_A, "||A^-1|| (col) =", norm_Ainv)
print("abs err bound =", abs_err_bound, "rel err bound =", rel_err_bound)
print("||B|| (col) =", norm_B_col, "||B|| (row) =", norm_B_row)
print("Jacobi solution (tol=1e-3):", x_jacobi, "iterations:", k_jacobi)
````

## 4. Результаты (кратко)

- Решение (метод Гаусса):  
    [  
    x \approx (-6.259293,; 10.308304,; 0.028751,; -1.199786)^T  
    ]
    
- Обратная матрица (A^{-1}) — см. раздел 2.3.
    
- Оценка абсолютной погрешности (при (\Delta b = 10^{-3})): (\le 0.00531355).
    
- Оценка относительной погрешности (оценка): (\approx 7.866\times 10^{-3}).
    
- Метод Якоби (вариант 1) — в данном случае **не сходится** (норма матрицы итераций (|B|\approx 8.23>1)), поэтому итерационное решение не получено.
    