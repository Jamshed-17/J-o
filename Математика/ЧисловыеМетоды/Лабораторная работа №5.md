**ВАРИАНТ 1**

**Название:** Решение системы линейных уравнений итерационными методами

**Цель:** Изучение и практическое применение итерационных методов (метод простой итерации, метод Якоби) для решения систем линейных алгебраических уравнений (СЛАУ).

## 2. Постановка задачи

**Вариант 1:** Дана система четырех линейных уравнений с четырьмя неизвестными:
$4.003 \cdot x_1 + 0.207 \cdot x_2 + 0.519 \cdot x_3 + 0.281 \cdot x_4 = 0.425$
$0.416 \cdot x_1 + 3.273 \cdot x_2 + 0.326 \cdot x_3 + 0.375 \cdot x_4 = 0.021$
$0.297 \cdot x_1 + 0.351 \cdot x_2 + 2.997 \cdot x_3 + 0.429 \cdot x_4 = 0.213$
$0.412 \cdot x_1 + 0.194 \cdot x_2 + 0.215 \cdot x_3 + 3.628 \cdot x_4 = 0.946$

Необходимо выполнить следующие задания:
1.  Решить систему уравнений методом Гаусса (для получения "точного" решения).
2.  Найти обратную матрицу $A^{-1}$.
3.  Зная, что свободные члены $\overline{b}$ имеют абсолютную погрешность $\Delta_{\overline{b}} = 0.001$, найти оценку абсолютной $\Delta_{\overline{x}}$ и относительной $\delta_{\overline{x}}$ погрешности решения.
4.  Преобразовать систему к виду, необходимому для применения метода простой итерации (МПИ). Выбрав $\overline{x}^{0}=\overline{0}$, найти $k_{0}$ — необходимое число итераций для достижения точности $\epsilon = 0.01$.
5.  Сделать $k_{0}$ итераций МПИ и найти приближенное решение. Определить уточненную (апостериорную) оценку погрешности.
6.  Решить систему **методом Якоби** (согласно варианту 1) с точностью $\epsilon = 0.001$.

## 3. Выведенные вспомогательные формулы и функции

Систему можно представить в виде $A\overline{x} = \overline{b}$.

### 1. Оценки погрешностей
Для оценок используется норма $||...||_{\infty}$ (в документе названа "кубической"), т.е. максимальная сумма модулей элементов в строке:
$||A|| = \max_{i} \sum_{j=1}^{n} |a_{ij}|$

-   **Абсолютная погрешность решения:** $\Delta_{\overline{x}}\le||A^{-1}||\cdot\Delta_{\overline{b}}$
-   **Относительная погрешность решения:** $\delta_{\overline{x}}\le||A||\cdot||A^{-1}||\cdot\delta_{\overline{b}}$, где $\delta_{\overline{b}}=\frac{\Delta_{\overline{b}}}{||\overline{b}||}$

### 2. Метод Простой Итерации (МПИ) и Метод Якоби
Оба метода требуют приведения системы $A\overline{x} = \overline{b}$ к виду $\overline{x} = B\overline{x} + \overline{c}$.
Для этого матрица $A$ представляется в виде $A = L + D + R$, где $D$ — диагональная, $L$ и $R$ — нижняя и верхняя треугольные матрицы.

$(L+D+R)\overline{x} = \overline{b}$
$D\overline{x} = -(L+R)\overline{x} + \overline{b}$
$\overline{x} = -D^{-1}(L+R)\overline{x} + D^{-1}\overline{b}$

Итерационный процесс (для МПИ и Якоби): $\overline{x}^{k+1} = B\overline{x}^{k} + \overline{c}$
-   Матрица итераций: $B = -D^{-1}(L+R)$
-   Вектор свободных членов: $\overline{c} = D^{-1}\overline{b}$

**Условие сходимости:** Метод сходится, если $||B|| < 1$.

**Априорная оценка (число шагов $k_0$ для МПИ):**
$k_0$ находится из неравенства $\frac{||B||^{k}}{1-||B||}\cdot||\overline{x}^{1}-\overline{x}^{0}|| < \epsilon$.
При $\overline{x}^{0}=\overline{0}$, $\overline{x}^{1} = B\overline{x}^{0} + \overline{c} = \overline{c}$.
$k > \frac{\ln(\frac{\epsilon \cdot (1-||B||)}{||\overline{c}||})}{\ln(||B||)}$

**Апостериорная оценка (уточненная погрешность МПИ):**
$\Delta_{\overline{x}_{k}}\le\frac{||B||}{1-||B||}\cdot||\overline{x}^{k}-\overline{x}^{k-1}||$

**Критерий остановки (для Якоби):**
Метод останавливается, когда апостериорная погрешность $\Delta_{\overline{x}_{k}} < \epsilon$.
$||\overline{x}^{k}-\overline{x}^{k-1}|| < \frac{\epsilon \cdot (1-||B||)}{||B||}$ (следует из и примера)

## 4. Таблицы с результатами расчётов

### Задание 1. Решение методом Гаусса (Точное решение)

Решение, полученное методом `np.linalg.solve`:
$\overline{x}_{exact} = (0.051935, -0.046065, 0.048003, 0.250504)^T$

### Задание 2. Обратная матрица $A^{-1}$

$A^{-1} = \begin{pmatrix}
 0.2523 & -0.0156 & -0.0441 & -0.0188 \\
 -0.0327 & 0.3094 & -0.0355 & -0.0314 \\
 -0.0270 & -0.0411 & 0.3413 & -0.0398 \\
 -0.0298 & -0.0169 & -0.0177 & 0.2787
\end{pmatrix}$

### Задание 3. Оценки погрешностей

-   $||A|| = \max(5.000, 4.390, 4.074, 4.449) = 5.000$
-   $||A^{-1}|| = \max(0.3308, 0.4090, 0.4492, 0.3431) = 0.4492$
-   $||\overline{b}|| = \max(0.425, 0.021, 0.213, 0.946) = 0.946$
-   $\Delta_{\overline{b}} = 0.001$
-   $\delta_{\overline{b}} = \frac{0.001}{0.946} \approx 0.001057$

**Абсолютная погрешность решения:**
$\Delta_{\overline{x}} \le ||A^{-1}|| \cdot \Delta_{\overline{b}} = 0.4492 \cdot 0.001 = 0.0004492$

**Относительная погрешность решения:**
$\delta_{\overline{x}} \le ||A|| \cdot ||A^{-1}|| \cdot \delta_{\overline{b}} = 5.000 \cdot 0.4492 \cdot 0.001057 \approx 0.002374$

### Задание 4. Подготовка к МПИ и расчёт $k_0$

Матрица $B$ и вектор $\overline{c}$:
$B = \begin{pmatrix}
 0 & -0.0517 & -0.1296 & -0.0702 \\
 -0.1271 & 0 & -0.0996 & -0.1146 \\
 -0.0991 & -0.1171 & 0 & -0.1431 \\
 -0.1136 & -0.0535 & -0.0593 & 0
\end{pmatrix}$

$\overline{c} = (0.10617, 0.006416, 0.07107, 0.26075)^T$

**Проверка сходимости:**
$||B|| = \max(0.2515, 0.3413, 0.3593, 0.2264) = 0.3593$
Так как $||B|| = 0.3593 < 1$, метод сходится.

**Расчёт $k_0$ для $\epsilon = 0.01$:**
-   $||\overline{c}|| = ||\overline{x}^1 - \overline{x}^0|| = 0.26075$
-   $k > \frac{\ln(\frac{0.01 \cdot (1 - 0.3593)}{0.26075})}{\ln(0.3593)} = \frac{\ln(0.02458)}{-1.0235} \approx 3.62$
-   Принимаем $k_0 = 4$

### Задание 5. Выполнение МПИ ($k_0 = 4$ шагов)

| k | $x_1$ | $x_2$ | $x_3$ | $x_4$ |
|---|---|---|---|---|
| 0 | 0.00000 | 0.00000 | 0.00000 | 0.00000 |
| 1 | 0.10617 | 0.00642 | 0.07107 | 0.26075 |
| 2 | 0.06821 | -0.04332 | 0.02251 | 0.23126 |
| 3 | 0.05734 | -0.04374 | 0.03639 | 0.24726 |
| 4 | 0.05378 | -0.04505 | 0.04279 | 0.24941 |

**Приближённое решение МПИ:** $\overline{x}_{mpi} = (0.05378, -0.04505, 0.04279, 0.24941)^T$

**Уточненная (апостериорная) оценка погрешности:**
$||\overline{x}^4 - \overline{x}^3|| = ||(-0.00356, -0.00131, 0.0064, 0.00215)^T|| = 0.0064$
$\Delta_{\overline{x}_4} \le \frac{0.3593}{1 - 0.3593} \cdot 0.0064 = 0.5608 \cdot 0.0064 \approx 0.00359$
Полученная погрешность $0.00359 < 0.01$, что удовлетворяет условию.

### Задание 6. Метод Якоби (Точность $\epsilon = 0.001$)

Критерий остановки: $||\overline{x}^{k}-\overline{x}^{k-1}|| < \frac{0.001 \cdot (1 - 0.3593)}{0.3593} \approx 0.00178$

| k   | $x_1$   | $x_2$    | $x_3$   | $x_4$   | $~ \Delta_k = \|\|\overline{x}^k - \overline{x}^{k-1}\|\|$ |
| --- | ------- | -------- | ------- | ------- | ---------------------------------------------------------- |
| 0   | 0.00000 | 0.00000  | 0.00000 | 0.00000 | -                                                          |
| 1   | 0.10617 | 0.00642  | 0.07107 | 0.26075 | 0.26075                                                    |
| 2   | 0.06821 | -0.04332 | 0.02251 | 0.23126 | 0.05791                                                    |
| 3   | 0.05734 | -0.04374 | 0.03639 | 0.24726 | 0.01599                                                    |
| 4   | 0.05378 | -0.04505 | 0.04279 | 0.24941 | 0.00640                                                    |
| 5   | 0.05244 | -0.04566 | 0.04576 | 0.25016 | 0.00297                                                    |
| 6   | 0.05206 | -0.04590 | 0.04705 | 0.25039 | 0.00129                                                    |


Процесс остановлен на 6-й итерации, так как $\Delta_6 = 0.00129 < 0.00178$.

**Приближённое решение (Якоби):** $\overline{x}_{jacobi} = (0.05206, -0.04590, 0.04705, 0.25039)^T$

## 5. Точное решение

Точное (машинное) решение системы, полученное методом Гаусса (см. Задание 1):
$\overline{x}_{exact} = (0.051935, -0.046065, 0.048003, 0.250504)^T$

## 6. Анализ полученных результатов и выводы

В ходе работы было выполнено решение СЛАУ различными методами.
1.  **Проверка сходимости:** Условие сходимости итерационных методов $||B|| = 0.3593 < 1$ выполнено, что гарантировало сходимость МПИ и метода Якоби.
2.  **МПИ:** Расчётное число итераций $k_0 = 4$ для точности $0.01$ оказалось верным. Полученное решение $\overline{x}_{mpi}$ имеет апостериорную погрешность $\approx 0.00359$, что меньше $\epsilon = 0.01$.
3.  **Метод Якоби:** Для достижения требуемой точности $\epsilon = 0.001$ потребовалось 6 итераций.
4.  **Сравнение:**
    -   $\overline{x}_{exact} \approx (0.0519, -0.0461, 0.0480, 0.2505)$
    -   $\overline{x}_{jacobi} \approx (0.0521, -0.0459, 0.0471, 0.2504)$
    -   $\overline{x}_{mpi} \approx (0.0538, -0.0451, 0.0428, 0.2494)$

**Вывод:** Метод Якоби (6 итераций) дал результат, значительно более близкий к "точному" решению, чем МПИ (4 итерации), что ожидаемо, так как для него была задана более высокая точность ($0.001$ против $0.01$). Оба итерационных метода успешно сошлись к решению. Оценки погрешностей, полученные в Задании 3 ($\Delta_{\overline{x}} \approx 0.00045$), подтверждают, что малая погрешность в векторе $\overline{b}$ приводит к малой погрешности в решении.

## 7. Листинг программы на Python
```python
import numpy as np

def solve_lab_4(A, b, delta_b_abs, epsilon_mpi, epsilon_jacobi):
    """
    Выполняет все задания лабораторной работы 4.
    """
    
    # Установка опций вывода numpy для красивого отображения
    np.set_printoptions(precision=5, suppress=True)

    print("--- Лабораторная работа 4 (Вариант 1) ---\n")

    # --- Задание 1. Решение методом Гаусса (Точное) ---
    print("--- Задание 1. Решение методом Гаусса (Точное) ---")
    try:
        x_exact = np.linalg.solve(A, b)
        print(f"x_exact = {x_exact}\n")
    except np.linalg.LinAlgError:
        print("Ошибка: Матрица A вырождена.\n")
        return

    # --- Задание 2. Обратная матрица A_inv ---
    print("--- Задание 2. Обратная матрица A_inv ---")
    A_inv = np.linalg.inv(A)
    print(f"{A_inv}\n")

    # --- Задание 3. Оценка погрешностей ---
    # Используем бесконечную норму (max по сумме строк)
    # ord=np.inf для векторов и матриц
    print("--- Задание 3. Оценка погрешностей ---")
    norm_A = np.linalg.norm(A, ord=np.inf)
    norm_A_inv = np.linalg.norm(A_inv, ord=np.inf)
    norm_b = np.linalg.norm(b, ord=np.inf)
    
    delta_b_rel = delta_b_abs / norm_b
    
    # Абсолютная погрешность решения
    delta_x_abs = norm_A_inv * delta_b_abs
    
    # Относительная погрешность решения
    delta_x_rel = norm_A * norm_A_inv * delta_b_rel
    
    print(f"Норма ||A||:     {norm_A:.3f}")
    print(f"Норма ||A_inv||: {norm_A_inv:.3f}")
    print(f"Норма ||b||:     {norm_b:.3f}")
    print(f"Абс. погрешность (b): {delta_b_abs}")
    print(f"Отн. погрешность (b): {delta_b_rel:.6f}")
    print(f"Оценка абс. погрешности решения (Delta_x):  <= {delta_x_abs:.6f}")
    print(f"Оценка отн. погрешности решения (delta_x): <= {delta_x_rel:.6f}\n")

    # --- Задание 4. Подготовка к МПИ и расчет k_0 ---
    print("--- Задание 4. Подготовка к МПИ и расчет k_0 ---")
    D = np.diag(np.diag(A))
    L = np.tril(A, k=-1)
    R = np.triu(A, k=1)
    
    D_inv = np.linalg.inv(D)
    
    # B и c для МПИ (и Якоби)
    B = -D_inv @ (L + R)
    c_vec = D_inv @ b
    
    print("Матрица B:")
    print(f"{B}")
    print("Вектор c:")
    print(f"{c_vec}\n")

    norm_B = np.linalg.norm(B, ord=np.inf)
    
    if norm_B >= 1:
        print(f"Норма ||B||: {norm_B:.4f}. Метод расходится.\n")
        return
    
    print(f"Норма ||B||: {norm_B:.4f}. Метод сходится, т.к. норма < 1.")
    
    # x_0 = 0, значит x_1 = c_vec
    # ||x_1 - x_0|| = ||c_vec||
    norm_c = np.linalg.norm(c_vec, ord=np.inf)
    print(f"Норма ||c||: {norm_c:.5f}")
    print(f"Требуемая точность (МПИ): {epsilon_mpi}")

    # k > log( (eps * (1-||B||)) / ||c|| ) / log(||B||)
    k_numerator = np.log((epsilon_mpi * (1 - norm_B)) / norm_c)
    k_denominator = np.log(norm_B)
    k_min = k_numerator / k_denominator
    k_0 = int(np.ceil(k_min))
    
    print(f"Расчетное число итераций k_0: {k_0}\n")

    # --- Задание 5. Выполнение МПИ (k_0 шагов) ---
    print(f"--- Задание 5. Выполнение МПИ (k_0 = {k_0} шагов) ---")
    x_k = np.zeros_like(b)
    print(f"k=0: x = {x_k}")
    
    x_k_prev = x_k.copy()
    for k in range(1, k_0 + 1):
        x_k_prev = x_k.copy()
        x_k = B @ x_k_prev + c_vec
        print(f"k={k}: x = {x_k}")
        
    x_mpi = x_k
    
    print(f"\nРешение МПИ (x_mpi): {x_mpi}")
    
    # Апостериорная оценка
    norm_diff = np.linalg.norm(x_mpi - x_k_prev, ord=np.inf)
    error_posteriori = (norm_B / (1 - norm_B)) * norm_diff
    
    print(f"Разница ||x_k - x_k-1||: {norm_diff:.5f}")
    print(f"Апостериорная оценка погрешности: <= {error_posteriori:.5f}")
    if error_posteriori < epsilon_mpi:
        print(f"({error_posteriori:.5f} < {epsilon_mpi}, точность достигнута)\n")
    else:
        print(f"({error_posteriori:.5f} >= {epsilon_mpi}, точность НЕ достигнута)\n")

    # --- Задание 6. Метод Якоби (Точность eps) ---
    print(f"--- Задание 6. Метод Якоби (Точность eps = {epsilon_jacobi}) ---")
    
    # Критерий остановки: ||x_k - x_k-1|| < (eps * (1-||B||)) / ||B||
    stop_criterion_val = (epsilon_jacobi * (1 - norm_B)) / norm_B
    print(f"Требуемая точность (Якоби): {epsilon_jacobi}")
    print(f"Критерий остановки ||x_k - x_k-1|| < {stop_criterion_val:.5f}")

    x_k = np.zeros_like(b)
    x_k_prev = x_k.copy()
    k = 0
    
    while True:
        print(f"k={k}: x = [{x_k[0]:.5f}, {x_k[1]:.5f}, {x_k[2]:.5f}, {x_k[3]:.5f}]", end="")
        
        if k == 0:
            # На первой итерации разницы нет
            delta_k_norm = np.inf
        else:
            delta_k_norm = np.linalg.norm(x_k - x_k_prev, ord=np.inf)
            print(f", Delta = {delta_k_norm:.5f}")
        
        # Проверка условия остановки (после k=0)
        if k > 0 and delta_k_norm < stop_criterion_val:
            print(f"Остановка: Delta ({delta_k_norm:.5f}) < Критерий ({stop_criterion_val:.5f})")
            break
            
        if k > 50: # Защита от бесконечного цикла
            print("\nПревышено 50 итераций.")
            break
            
        # Следующий шаг
        x_k_prev = x_k.copy()
        x_k = B @ x_k_prev + c_vec
        k += 1
        
        if k == 1:
            print("") # Перевод строки после k=0
            
    x_jacobi = x_k
    print(f"\nРешение (Якоби): {x_jacobi}")
    print(f"Потребовалось итераций: {k}")


if __name__ == "__main__":
    
    # --- ВАРИАНТ 1 ---
    [cite_start]# [cite: 216]
    A_matrix = np.array([
        [4.003, 0.207, 0.519, 0.281],
        [0.416, 3.273, 0.326, 0.375],
        [0.297, 0.351, 2.997, 0.429],
        [0.412, 0.194, 0.215, 3.628]
    ])
    
    b_vector = np.array([0.425, 0.021, 0.213, 0.946])
    
    # Параметры из задания
    [cite_start]DELTA_B = 0.001       # [cite: 92]
    [cite_start]EPSILON_MPI = 0.01    # [cite: 94]
    [cite_start]EPSILON_JACOBI = 0.001 # [cite: 105]

    solve_lab_4(A_matrix, b_vector, DELTA_B, EPSILON_MPI, EPSILON_JACOBI)
````