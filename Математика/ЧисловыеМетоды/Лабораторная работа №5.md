**ВАРИАНТ 1**

**Название:** Интерполяция таблично заданных функций.

**Цель:** Научиться вычислять промежуточные значения функции по табличным данным с помощью формулы линейной интерполяции и оценивать погрешность интерполяции.

## 2. Постановка задачи

**Вариант 1:**
Используя формулу линейной интерполяции, выполнить следующие задания и округлить ответы до трёх знаков после запятой.

1.  **Задание 1:** Функция задана таблично. Найти $y$ при $x = 1.5$.
2.  **Задание 2:** Температура воздуха в 6:00 – 12°С, в 10:00 – 20°С. Оценить температуру в 8:30.
3.  **Задание 3:** Дана таблица $f(x) = \sqrt{x}$ (узлы $x=1$ и $x=4$). Вычислить приближенное $\sqrt{2.5}$. Сравнить с точным значением ($\approx 1.581$) и найти абсолютную погрешность.
4.  **Задание 4:** Уровень воды в 9:00 – 1,8 м, в 15:00 – 3,0 м. Определить, когда уровень достигнет 2,4 м.
5.  **Задание 5:** Объяснить, почему линейная интерполяция может дать большую погрешность для быстро изменяющихся функций, и привести пример.

## 3. Выведенные вспомогательные формулы и функции

**1. Линейная интерполяция**
Для нахождения $y$ в точке $x \in [x_0, x_1]$ используется формула:
$y = y_0 + \frac{y_1 - y_0}{x_1 - x_0}(x - x_0)$

**2. Обратная линейная интерполяция**
Для нахождения $x$ по известному $y \in [y_0, y_1]$ (используется в Задании 4), формула алгебраически преобразуется:
$(x - x_0) = (y - y_0) \cdot \frac{x_1 - x_0}{y_1 - y_0}$
$x = x_0 + (y - y_0) \cdot \frac{x_1 - x_0}{y_1 - y_0}$

**3. Абсолютная погрешность**
Разность (по модулю) между точным $f(x)$ и приближённым $P(x)$ значением:
$\Delta = |f(x) - P(x)|$

## 4. Таблицы с результатами расчётов

### Задание 1. Интерполяция по таблице

Для $x = 1.5$ выбираем отрезок $x_0 = 0$, $x_1 = 2$.
-   $x_0 = 0, y_0 = 1$
-   $x_1 = 2, y_1 = 3$
-   $x = 1.5$

$y = 1 + \frac{3 - 1}{2 - 0}(1.5 - 0) = 1 + \frac{2}{2}(1.5) = 1 + 1.5 = 2.5$

| $x_0$ | $y_0$ | $x_1$ | $y_1$ | $x$ | $y$ (приближ.) |
| :---: | :---: | :---: | :---: | :---: | :---: |
| 0 | 1 | 2 | 3 | 1.5 | **2.500** |

### Задание 2. Оценка температуры

Переведем время в часы: 6:00 = 6.0; 10:00 = 10.0; 8:30 = 8.5.
-   $x_0 = 6.0, y_0 = 12$
-   $x_1 = 10.0, y_1 = 20$
-   $x = 8.5$

$y = 12 + \frac{20 - 12}{10.0 - 6.0}(8.5 - 6.0) = 12 + \frac{8}{4}(2.5) = 12 + 2(2.5) = 17$

| $x_0$ (время) | $y_0$ (t, °C) | $x_1$ (время) | $y_1$ (t, °C) | $x$ (время) | $y$ (t, °C) |
| :---: | :---: | :---: | :---: | :---: | :---: |
| 6.0 | 12 | 10.0 | 20 | 8.5 | **17.000** |

### Задание 3. $f(x) = \sqrt{x}$

Используем узлы $x_0 = 1, x_1 = 4$ для $x = 2.5$.
-   $x_0 = 1, y_0 = 1.000$
-   $x_1 = 4, y_1 = 2.000$
-   $x = 2.5$

$y = 1.000 + \frac{2.000 - 1.000}{4 - 1}(2.5 - 1) = 1 + \frac{1}{3}(1.5) = 1 + 0.5 = 1.5$

| $x$ | $y$ (приближ.) | $f(x)$ (точное) | Абс. погрешность $\Delta$ |               |                    |
| :-: | :------------: | :-------------: | :-----------------------: | ------------- | ------------------ |
| 2.5 |     1.500      |      1.581      |             $             | 1.581 - 1.500 | $= \mathbf{0.081}$ |

### Задание 4. Определение времени (Обратная интерполяция)

Ищем $x$ (время в часах), когда $y = 2.4$ м.
-   $x_0 = 9.0, y_0 = 1.8$
-   $x_1 = 15.0, y_1 = 3.0$
-   $y = 2.4$

$x = 9.0 + (2.4 - 1.8) \cdot \frac{15.0 - 9.0}{3.0 - 1.8} = 9.0 + (0.6) \cdot \frac{6}{1.2} = 9.0 + 0.6 \cdot 5 = 12.0$

| $y_0$ (м) | $x_0$ (час) | $y_1$ (м) | $x_1$ (час) | $y$ (м) | $x$ (час) |
| :---: | :---: | :---: | :---: | :---: | :---: |
| 1.8 | 9.0 | 3.0 | 15.0 | 2.4 | **12.000** (т.е. 12:00) |

### Задание 5. Погрешность для нелинейных функций

Линейная интерполяция аппроксимирует функцию отрезком прямой. Если функция "быстро изменяется" (т.е. имеет большую кривизну, $f''(x) \neq 0$), то прямая линия, соединяющая две точки, будет плохим приближением для кривой между ними.

**Пример:** $f(x) = x^2$ на отрезке $[0, 10]$.
-   Узлы: $(x_0, y_0) = (0, 0)$ и $(x_1, y_1) = (10, 100)$.
-   Найдем $f(5)$ интерполяцией:
    $y = 0 + \frac{100 - 0}{10 - 0}(5 - 0) = 50$.
-   Точное значение: $f(5) = 5^2 = 25$.
-   **Погрешность:** $\Delta = |25 - 50| = 25$. Ошибка очень велика, так как прямая "срезала" параболу.

## 5. Точное решение

"Точное решение" в задачах интерполяции — это истинное значение функции $f(x)$ в интерполируемой точке. Мы можем его найти, только если аналитический вид $f(x)$ известен.

-   В Задании 1 и 2 $f(x)$ неизвестна.
-   В Задании 3 $f(x) = \sqrt{x}$, точное значение $f(2.5) = \sqrt{2.5} \approx 1.581$. Наше приближение $P(2.5) = 1.500$.
-   В Задании 4 $f(x)$ неизвестна.

Линейная интерполяция дает точный результат, только если функция сама является линейной ($f(x) = ax+b$) на отрезке $[x_0, x_1]$.

## 6. Анализ полученных результатов и выводы

В ходе работы мы освоили применение формулы линейной интерполяции.

1.  Задания 1, 2 и 4 показали, как находить промежуточные значения (прямая интерполяция) и аргументы (обратная интерполяция) для практических задач.
2.  Задание 3 продемонстрировало погрешность метода. Для $f(x) = \sqrt{x}$ на отрезке $[1, 4]$ погрешность составила $0.081$. Это связано с тем, что функция $\sqrt{x}$ не является линейной.
3.  Задание 5 теоретически объяснило причину этой погрешности: линейная интерполяция заменяет кривую $f(x)$ хордой (прямой).

**Вывод:** Линейная интерполяция — это простой и быстрый метод для оценки значений на небольших интервалах, где функцию можно считать близкой к линейной. Для функций с высокой кривизной (как в Задании 3 и 5) или на больших интервалах этот метод даёт существенную погрешность.

## 7. Ответы на контрольные вопросы

1.  **В чем суть линейной интерполяции?**
    Суть в нахождении промежуточного значения $y$ для аргумента $x$, исходя из предположения, что функция на отрезке между двумя известными точками $(x_0, y_0)$ и $(x_1, y_1)$ изменяется линейно.

2.  **Какая геометрическая фигура используется при линейной интерполяции?**
    Отрезок прямой линии, соединяющий два узла интерполяции.

3.  **Почему важно посетить пост председателя интерполяции?**
    Вопрос неясен, вероятно, содержит опечатку, и не основан на теоретическом материале лабораторной работы.

4.  **В каких случаях линейная интерполяция дает достоверный (точный) результат?**
    Когда функция, заданная таблично, сама является линейной (вида $f(x) = ax+b$) на рассматриваемом отрезке.

5.  **Чем интерполяция отличается от экстраполяции?**
    **Интерполяция** — это нахождение промежуточных значений *внутри* диапазона известных данных ($x \in [x_0, x_n]$). **Экстраполяция** — это нахождение значений *вне* этого диапазона ($x < x_0$ или $x > x_n$), что обычно является менее надежной оценкой.

## 8. Листинг программы на Python

```python
import math

# --- Основные функции ---

def linear_interpolation(x0, y0, x1, y1, x):
    """
    [cite_start]Вычисляет линейную интерполяцию для y(x) по формуле[cite: 36, 59].
    Формула: y = y0 + ((y1-y0)/(x1-x0)) * (x-x0)
    """
    if (x1 - x0) == 0:
        print("Ошибка: x1 и x0 равны. Деление на ноль.")
        return y0
    
    y = y0 + ((y1 - y0) / (x1 - x0)) * (x - x0)
    return y

def inverse_linear_interpolation(x0, y0, x1, y1, y):
    """
    Вычисляет обратную линейную интерполяцию для x(y).
    Формула: x = x0 + ((x1-x0)/(y1-y0)) * (y-y0)
    """
    if (y1 - y0) == 0:
        print("Ошибка: y1 и y0 равны. Деление на ноль.")
        return x0
        
    x = x0 + ((x1 - x0) / (y1 - y0)) * (y - y0)
    return x

# --- Вспомогательные функции для Заданий 2 и 4 ---

def time_to_hours(hours, minutes):
    """Вспомогательная функция для перевода времени в часы"""
    return hours + minutes / 60

def hours_to_time_str(hours_float):
    """Вспомогательная функция для перевода часов в строку ЧЧ:ММ"""
    hours = int(hours_float)
    # Округляем минуты, чтобы избежать 11:59
    minutes = int((hours_float - hours) * 60 + 0.5) 
    if minutes == 60:
        hours += 1
        minutes = 0
    return f"{hours:02d}:{minutes:02d}"

# --- Основная программа ---
if __name__ == "__main__":
    
    print("--- Лабораторная работа №5 (Вариант 1) ---")
    
    # --- Задание 1 ---
    # [cite_start]Данные: x=[0, 2], y=[1, 3][cite: 61, 64]. [cite_start]Найти y(1.5)[cite: 66].
    print("\n--- Задание 1 ---")
    x_task1 = 1.5
    y_task1 = linear_interpolation(x0=0, y0=1, x1=2, y1=3, x=x_task1)
    print(f"Данные: (0, 1), (2, 3)")
    [cite_start]# [cite: 60] - округление до 3 знаков
    print(f"При x = {x_task1}, y = {y_task1:.3f}")

    # --- Задание 2 ---
    # 6:00 (12C), 10:00 (20C). [cite_start]Найти T(8:30)[cite: 65, 68].
    print("\n--- Задание 2 ---")
    x0_t = time_to_hours(6, 0)  # 6.0
    y0_t = 12
    x1_t = time_to_hours(10, 0) # 10.0
    y1_t = 20
    x_t = time_to_hours(8, 30)  # 8.5
    
    y_t = linear_interpolation(x0_t, y0_t, x1_t, y1_t, x_t)
    print(f"Данные: (6:00, 12°C), (10:00, 20°C)")
    print(f"Температура в 8:30 (x={x_t}) = {y_t:.3f}°C")

    # --- Задание 3 ---
    # f(x)=sqrt(x). (1, 1)[cite_start], (4, 2)[cite: 71]. Найти sqrt(2.5). [cite_start]Точное=1.581[cite: 72].
    print("\n--- Задание 3 ---")
    x0_sqrt = 1
    y0_sqrt = 1.000
    x1_sqrt = 4
    y1_sqrt = 2.000
    x_sqrt = 2.5
    
    y_approx_sqrt = linear_interpolation(x0_sqrt, y0_sqrt, x1_sqrt, y1_sqrt, x_sqrt)
    [cite_start]y_exact_sqrt = 1.581 # [cite: 72]
    
    # [cite_start]Абсолютная погрешность [cite: 38, 73]
    error_sqrt = abs(y_exact_sqrt - y_approx_sqrt) 
    
    print(f"Данные: f(1)=1.000, f(4)=2.000")
    print(f"Приближенное sqrt(2.5) = {y_approx_sqrt:.3f}")
    print(f"Точное sqrt(2.5) ≈ {y_exact_sqrt}")
    print(f"Абсолютная погрешность = |{y_exact_sqrt} - {y_approx_sqrt:.3f}| = {error_sqrt:.3f}")

    # --- Задание 4 ---
    # 9:00 (1.8m), 15:00 (3.0m). [cite_start]Когда 2.4m? [cite: 76, 77] (Обратная интерполяция)
    print("\n--- Задание 4 ---")
    x0_lvl = 9.0  # 9:00
    y0_lvl = 1.8
    x1_lvl = 15.0 # 15:00
    y1_lvl = 3.0
    y_lvl = 2.4
    
    x_time = inverse_linear_interpolation(x0_lvl, y0_lvl, x1_lvl, y1_lvl, y_lvl)
    time_str = hours_to_time_str(x_time)
    
    print(f"Данные: (9:00, 1.8 м), (15:00, 3.0 м)")
    print(f"Уровень {y_lvl} м будет достигнут в {x_time:.3f} часов, т.е. в {time_str}")

    # --- Задание 5 ---
    # [cite_start]Почему погрешность велика для f(x) = x^2? [cite: 79]
    print("\n--- Задание 5 (Анализ) ---")
    x0_ex = 0
    y0_ex = x0_ex**2
    x1_ex = 10
    y1_ex = x1_ex**2
    x_ex = 5
    
    y_approx_ex = linear_interpolation(x0_ex, y0_ex, x1_ex, y1_ex, x_ex)
    y_exact_ex = x_ex**2
    error_ex = abs(y_exact_ex - y_approx_ex)
    
    [cite_start]print(f"Линейная интерполяция заменяет кривую прямой. [cite: 37]")
    print(f"Если функция быстро меняется (большая кривизна), прямая 'срезает' кривую.")
    print(f"Пример: f(x) = x^2 на [0, 10]. Узлы: (0, 0) и (10, 100).")
    print(f"  Интерполяция в x=5: y = {y_approx_ex:.3f}")
    print(f"  Точное значение f(5): {y_exact_ex:.3f}")
    print(f"  Погрешность: {error_ex:.3f}")
````