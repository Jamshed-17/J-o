**1. Перечислите основные свойства транзакций.**

Основные свойства транзакций описываются аббревиатурой **ACID**:
1. **Атомарность (Atomicity)**: Транзакция выполняется как единое целое. Либо выполняются все её операции, либо ни одной.
2. **Согласованность (Consistency)**: Транзакция переводит базу данных из одного целостного состояния в другое целостное состояние, не нарушая ограничений целостности.
3. **Изолированность (Isolation)**: Параллельно выполняемые транзакции не должны влиять друг на друга. Результаты промежуточных шагов одной транзакции не видны другим транзакциям до её завершения.
4. **Долговечность (Durability)**: После успешного завершения транзакции (фиксации) внесённые ею изменения становятся постоянными и сохраняются в базе данных даже в случае сбоев системы.

**2. В чем разница между явными и неявными транзакциями?**

*   **Явные транзакции** явно определяются программистом с использованием операторов начала (`BEGIN TRANSACTION`), фиксации (`COMMIT`) или отката (`ROLLBACK`) транзакции.
*   **Неявные транзакции** автоматически начинаются СУБД при выполнении определенных операторов (например, `INSERT`, `UPDATE`, `DELETE`) и должны быть явно завершены программистом командой `COMMIT` или `ROLLBACK`. В некоторых режимах каждая отдельная инструкция выполняется как транзакция.

**3. В чем заключается проблема потерянного обновления?**

**Проблема потерянного обновления** возникает, когда две или более транзакции читают одну и ту же запись для последующего изменения, и изменения, сделанные одной транзакцией, перезаписываются (теряются) изменениями другой, так как они основывались на устаревшем значении. Это классический пример конфликта при параллельном выполнении.

**4. Назовите основные типы блокировок.**

Основные типы блокировок по режиму доступа:
1.  **Разделяемая блокировка (Shared Lock, S-Lock)**: Позволяет транзакции читать данные. Несколько транзакций могут одновременно удерживать разделяемые блокировки на одном ресурсе, но ни одна из них не может установить эксклюзивную блокировку.
2.  **Монопольная блокировка (Exclusive Lock, X-Lock)**: Позволяет транзакции изменять данные (писать). Только одна транзакция может удерживать эксклюзивную блокировку на ресурсе. Никакие другие блокировки (ни разделяемые, ни эксклюзивные) не могут быть установлены другими транзакциями на этот ресурс.

Также существуют блокировки по гранулярности (уровню): блокировка строки, страницы, таблицы, базы данных.

**5. Перечислите уровни изоляции транзакций, определенные в стандарте SQL—92.**

Стандарт SQL-92 определяет четыре уровня изоляции (от наименее строгого к наиболее строгому):
1.  **Read uncommitted (Чтение незафиксированных данных)**.
2.  **Read committed (Чтение зафиксированных данных)**.
3.  **Repeatable read (Повторяемое чтение)**.
4.  **Serializable (Упорядочиваемость или Сериализуемость)**.

**6. Какой минимальный уровень изоляции требуется, чтобы избежать проблем, связанных с неповторяемым чтением?**

Чтобы избежать проблемы **неповторяемого чтения**, минимально необходимый уровень изоляции — **Repeatable read**.

**7. Какой из уровней изоляции транзакций, поддерживаемых СУБД SQL Server, не определен в стандарте SQL—92?**

В Microsoft SQL Server уровень изоляции **SNAPSHOT** (а также READ COMMITTED SNAPSHOT) не определен в стандарте SQL-92. Он основан на механизме управления версиями строк (MVCC), а не на блокировках.

**8. Каким образом обеспечивается свойство долговечности транзакций?**

Свойство **долговечности** обеспечивается в первую очередь механизмом **журнализации (ведения лога транзакций)**. Перед тем как изменения будут записаны в основные файлы данных, информация об этих изменениях (до/после) записывается в устойчивое хранилище — журнал транзакций. После этого даже в случае сбоя (например, отключения питания) СУБД может **восстановить (Redo)** зафиксированные транзакции из журнала.

**9. В чем заключается суть протокола двухфазной фиксации?**

**Протокол двухфазной фиксации (2PC)** — это алгоритм распределённых транзакций, гарантирующий атомарность фиксации транзакции, затрагивающей несколько независимых ресурсов (например, разные базы данных). Его суть заключается в двух фазах:
1.  **Фаза подготовки (Prepare Phase)**: Координатор (менеджер транзакций) рассылает всем участникам (ресурсным менеджерам) запрос «подготовиться к фиксации». Участники выполняют все операции транзакции локально, записывают изменения в лог и отвечают «готов» или «не готов».
2.  **Фаза фиксации/отката (Commit/Rollback Phase)**: Если **все** участники ответили «готов», координатор рассылает команду **«фиксировать»**. Если хотя бы один участник ответил «не готов» (или не ответил в течение таймаута), координатор рассылает команду **«откатить»**. Участники выполняют полученную команду и отчитываются о результате.